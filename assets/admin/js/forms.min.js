jQuery(document).ready(function(i){i(document.body).on("click",".jb-change-media",function(e){e.preventDefault(),i(this).parents(".jb-uploaded-wrapper").removeClass("jb-uploaded").addClass("jb-waiting-change"),i(this).parents(".jb-uploaded-wrapper").siblings(".jb-uploader").removeClass("jb-uploaded")}),i(document.body).on("click",".jb-cancel-change-media",function(e){e.preventDefault(),i(this).parents(".jb-uploaded-wrapper").addClass("jb-uploaded").removeClass("jb-waiting-change"),i(this).parents(".jb-uploaded-wrapper").siblings(".jb-uploader").addClass("jb-uploaded")}),i(document.body).on("click",".jb-clear-media",function(e){e.preventDefault(),r.splice(),i(this).parents(".jb-uploaded-wrapper").siblings(".jb-media-value").val(""),i(this).parents(".jb-uploaded-wrapper").siblings(".jb-media-value-hash").val(""),i(this).parents(".jb-uploaded-wrapper").removeClass("jb-uploaded").removeClass("jb-waiting-change"),i(this).parents(".jb-uploaded-wrapper").siblings(".jb-uploader").removeClass("jb-uploaded")}),i(".jb-select-media").each(function(){var l=i(this),e=l.data("action"),t=l.parents(".jb-uploader-dropzone"),a=l.parents(".jb-select-media-button-wrapper"),s=t.siblings(".jb-uploader-errorlist"),a={browse_button:l.get(0),drop_element:t.get(0),container:a.get(0),url:wp.ajax.settings.url+"?action="+e+"&nonce="+jb_admin_data.nonce+"&admin=1",chunk_size:"1024kb",max_retries:1,multipart:!0,multi_selection:!1,filters:{max_file_size:"10mb",mime_types:[{title:wp.i18n.__("Image files","jobboardwp"),extensions:"jpg,jpeg,gif,png,bmp,ico,tiff"}],prevent_duplicates:!0,max_file_count:1},init:{Error:function(e,a){s.html("<p>"+wp.i18n.__("Error!","jobboardwp")+" "+a.message+"</p>")},FileFiltered:function(i,e){s.empty(),i.getOption("multi_selection")||t.find(".jb-uploader-file").each(function(e,a){i.removeFile(a.id)})},FilesAdded:function(e,a){e.start()},FilesRemoved:function(e,a){i.each(a,function(e,a){i("#"+a.id).remove()}),t.find(".jb-uploader-file").length||s.empty()},FileUploaded:function(e,a,i){var t;200===i.status&&i.response?(t=JSON.parse(i.response))?t.info&&0===t.OK?console.error(t.info):t.data&&(l.parents(".jb-uploader").addClass("jb-uploaded"),l.parents(".jb-uploader").siblings(".jb-uploaded-wrapper").addClass("jb-uploaded").removeClass("jb-waiting-change"),l.parents(".jb-uploader").siblings(".jb-uploaded-wrapper").find("img").attr("src",t.data[0].url),wp.hooks.doAction("jb_job_admin_uploader_after_success_upload",l,t),l.parents(".jb-uploader").siblings(".jb-media-value").val(t.data[0].name_saved),jQuery(".jb-media-value-save").length&&l.parents(".jb-uploader").siblings(".jb-media-value-save").val(t.data[0].name_saved),l.parents(".jb-uploader").siblings(".jb-media-value-hash").val(t.data[0].hash)):s.append("<p>"+wp.i18n.__("Error! Wrong file upload server response.","jobboardwp")+"</p>"):console.error(wp.i18n.__("File was not loaded, Status Code %s","jobboardwp"),[i.status])},PostInit:function(e){t.find(".jb-uploader-file").remove()},UploadProgress:function(e,a){i("#"+a.id).find("b").html("<span>"+a.percent+"%</span>")},UploadComplete:function(e,a){}}},a=wp.hooks.applyFilters("jb_job_admin_uploader_filters_attrs",a,l);(r=new plupload.Uploader(a)).init()}),"function"==typeof i.fn.select2&&(jQuery(".jb-pages-select2").select2({ajax:{url:wp.ajax.settings.url,dataType:"json",delay:250,data:function(e){return{search:e.term,action:"jb_get_pages_list",page:e.page||1,nonce:jb_admin_data.nonce}},processResults:function(e,a){a.page=a.page||1;var i=[];return e&&jQuery.each(e,function(e,a){"total_count"!==e&&i.push({id:a[0],text:a[1]})}),{results:i,pagination:{more:10*a.page<e.total_count}}},cache:!0},placeholder:jQuery(this).data("placeholder"),minimumInputLength:0,allowClear:!0}),i(".jb-s1").select2({allowClear:!0,placeholder:jQuery(this).data("placeholder")}),i(".jb-s2").select2({allowClear:!1,placeholder:jQuery(this).data("placeholder")}),i(".jb-s3").select2({tags:!0,allowClear:!0,placeholder:jQuery(this).data("placeholder")}));var r,t,e=i(".jb-admin-colorpicker"),e=(e.length&&e.wpColorPicker(),i(".jb-datepicker"));function a(){jQuery(".jb-forms-line").removeClass("jb-forms-line-conditioned").each(function(){void 0===jQuery(this).data("conditional")||jQuery(this).hasClass("jb-forms-line-conditioned")||(!function t(e){e.addClass("jb-forms-line-conditioned");var a=e.data("conditional");var i=a[1];var l=a[2];var s=e.data("prefix");var r=!0;{var n;-1===a[0].indexOf("||")&&void 0!==(n=jQuery("#"+s+"_"+a[0])).parents(".jb-forms-line").data("conditional")&&(r=t(n.parents(".jb-forms-line")))}e="";var d="";var o=!1;if("="===i){var p,u;if(-1!==a[0].indexOf("||"))return p=!1,u=a[0].split("||"),jQuery.each(u,function(e){var a,e=jQuery("#"+s+"_"+u[e]),i=(r=!(o=!1),void 0!==e.parents(".jb-forms-line").data("conditional")&&(r=t(e.parents(".jb-forms-line"))),e.prop("tagName").toLowerCase());"input"===i?(a=e.attr("type"),o="checkbox"===a?"1"==l?e.is(":checked"):!e.is(":checked"):Array.isArray(l)?-1!==l.indexOf(e.val()):e.val()===l):"select"===i&&(o=Array.isArray(l)?-1!==l.indexOf(e.val()):e.val()===l),o&&r&&(p=!0)}),p;"input"===(e=n.prop("tagName").toLowerCase())?(d=n.attr("type"),o="checkbox"===d?"1"===l?n.is(":checked"):!n.is(":checked"):Array.isArray(l)?-1!==l.indexOf(n.val()):n.val()===l):"select"===e&&(o=Array.isArray(l)?-1!==l.indexOf(n.val()):n.val()===l)}else"!="===i&&("input"===(e=n.prop("tagName").toLowerCase())?(d=n.attr("type"),o="checkbox"===d?"1"===l?!n.is(":checked"):n.is(":checked"):n.val()!==l):"select"===e&&(o=n.val()!==l));return o&&r}(jQuery(this))?(jQuery(this).hide(),jQuery(this).find("select, input").prop("disabled",!0)):(jQuery(this).show(),jQuery(this).find("select, input").prop("disabled",!1)))})}e.length&&e.each(function(){var e=i(this);e.datepicker({altField:e.siblings(".jb-datepicker-default-format"),altFormat:"yy-mm-dd"})}),i(document.body).on("change",".jb-datepicker",function(){var e=i(this);""===e.val()&&e.siblings(".jb-datepicker-default-format").val("")}),jb_init_helptips(),jQuery(".jb-media-upload").each(function(){var e=jQuery(this).find(".jb-forms-field"),a=e.data("default");""!==e.val()&&e.val()!==a?(e.siblings(".jb-set-image").hide(),e.siblings(".jb-clear-image").show(),e.siblings(".icon_preview").show()):(e.val()===a&&e.siblings(".icon_preview").show(),e.siblings(".jb-set-image").show(),e.siblings(".jb-clear-image").hide())}),"undefined"!=typeof wp&&wp.media&&wp.media.editor&&(jQuery(".jb-set-image").click(function(e){var a=jQuery(this);e.preventDefault(),t&&t.remove(),(t=wp.media({title:a.data("upload_frame"),button:{text:php_data.texts.select},multiple:!1})).on("select",function(){var e=t.state().get("selection").first().toJSON();a.siblings(".icon_preview").attr("src",e.url).show(),a.siblings(".jb-forms-field").val(e.url),a.siblings(".jb-media-upload-data-id").val(e.id),a.siblings(".jb-media-upload-data-width").val(e.width),a.siblings(".jb-media-upload-data-height").val(e.height),a.siblings(".jb-media-upload-data-thumbnail").val(e.thumbnail),a.siblings(".jb-media-upload-data-url").trigger("change"),a.siblings(".jb-media-upload-url").val(e.url),a.siblings(".jb-clear-image").show(),a.hide(),jQuery(document).trigger("jb_media_upload_select",[a,e])}),t.open()}),jQuery(".icon_preview").click(function(e){jQuery(this).siblings(".jb-set-image").trigger("click")}),jQuery(".jb-clear-image").click(function(){var e=jQuery(this),a=e.siblings(".jb-forms-field").data("default");e.siblings(".jb-set-image").show(),e.hide(),e.siblings(".icon_preview").attr("src",a),e.siblings(".jb-media-upload-data-id").val(""),e.siblings(".jb-media-upload-data-width").val(""),e.siblings(".jb-media-upload-data-height").val(""),e.siblings(".jb-media-upload-data-thumbnail").val(""),e.siblings(".jb-forms-field").val(a),e.siblings(".jb-media-upload-data-url").trigger("change"),e.siblings(".jb-media-upload-url").val(a),jQuery(document).trigger("jb_media_upload_clear",e)})),jQuery(document.body).on("change",".jb-forms-field",function(){(0<jQuery(".jb-forms-line[data-conditional*='\""+jQuery(this).data("field_id")+"\",']").length||0<jQuery(".jb-forms-line[data-conditional*='"+jQuery(this).data("field_id")+"|']").length||0<jQuery(".jb-forms-line[data-conditional*='|"+jQuery(this).data("field_id")+"']").length)&&a()}),a()});