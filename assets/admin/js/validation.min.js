!function(n){var r,t,i,a,s=wp.data.dispatch("core/editor"),e=wp.data.select("core/editor"),c=wp.data.dispatch("core/notices"),d=!1,l=s.savePost,b=!1;wp.data.subscribe(function(){var o=e.getEditedPostAttribute("status");b="publish"===o||"future"===o,0}),s.savePost=function(a){a=a||{};var o=this,e=arguments;return new Promise(function(e,o){var i,t;return r=e,d||!a.isAutosave&&!a.isPreview?b?(t=n("form.metabox-location-normal").serializeArray(),i={},n(t).each(function(o,e){var t=e.name.substring(e.name.lastIndexOf("[")+1,e.name.lastIndexOf("]"));i[t]=e.value}),t=wp.data.select("core/editor").getEditedPostContent(),void wp.ajax.send("jb-validate-job-data",{data:{description:t,data:i,nonce:jb_admin_data.nonce},success:function(o){n(".jb-forms-line .jb-forms-field").css("border","#8c8f94 solid 1px"),n(".jb-forms-line .jb-forms-field").parent().find("p.description").css("color","#2c3338"),d=o.valid?(c.removeNotice("jbwp-validation"),e("Validation bypassed."),s.unlockPostSaving("jbwp"),c.removeNotice("jbwp-validation"),!1):(o.empty&&o.empty.forEach(function(o,e,t){n("#jb-job-meta_"+o).css("border","#d63638 solid 1px")}),o.wrong&&o.wrong.forEach(function(o,e,t){n("#jb-job-meta_"+o).css("border","#d63638 solid 1px"),n("#jb-job-meta_"+o).parent().find("p.description").css("color","#d63638")}),s.lockPostSaving("jbwp"),c.createErrorNotice(o.notice,{id:"jbwp-validation",isDismissible:!0}),!0)},error:function(o){console.log(o),s.unlockPostSaving("jbwp"),d=!1}})):e("Validation ignored (draft)."):e("Validation ignored (autosave).")}).then(function(){return l.apply(o,e)}).catch(function(o){})},n(document.body).on("keyup",".jb-forms-line .jb-forms-field",(t=function(){var i,o;d&&(o=n("form.metabox-location-normal").serializeArray(),i={},n(o).each(function(o,e){var t=e.name.substring(e.name.lastIndexOf("[")+1,e.name.lastIndexOf("]"));i[t]=e.value}),o=wp.data.select("core/editor").getEditedPostContent(),wp.ajax.send("jb-validate-job-data",{data:{description:o,data:i,nonce:jb_admin_data.nonce},success:function(o){n(".jb-forms-line .jb-forms-field").css("border","#8c8f94 solid 1px"),n(".jb-forms-line .jb-forms-field").parent().find("p.description").css("color","#2c3338"),o.valid?(c.removeNotice("jbwp-validation"),s.unlockPostSaving("jbwp"),c.removeNotice("jbwp-validation"),d=!1,r("Validation bypassed.")):(o.empty&&o.empty.forEach(function(o,e,t){n("#jb-job-meta_"+o).css("border","#d63638 solid 1px")}),o.wrong&&o.wrong.forEach(function(o,e,t){n("#jb-job-meta_"+o).css("border","#d63638 solid 1px"),n("#jb-job-meta_"+o).parent().find("p.description").css("color","#d63638")}),s.lockPostSaving("jbwp"),c.createErrorNotice(o.notice,{id:"jbwp-validation",isDismissible:!0}),d=!0)},error:function(o){console.log(o),s.unlockPostSaving("jbwp"),d=!1}}))},i=1e3,a=0,function(){var o=this,e=arguments;clearTimeout(a),a=setTimeout(function(){t.apply(o,e)},i||0)}))}(jQuery);